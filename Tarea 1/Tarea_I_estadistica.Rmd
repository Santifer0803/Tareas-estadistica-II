---
title: "Tarea_1"
author: Alejandro Brenes (C21319), Santiago Fernández (C22943), Eyeri Méndez (C24765)
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
suppressPackageStartupMessages(library(dplyr))
```

Inicialmente, se cargan todas las librerías necesarias para la tarea.

```{r librerias}
pacman::p_load(readxl,
               dplyr,
               univariateML,
               rriskDistributions,
               ks,
               boot)
```

Se lee la base de datos necesaria.

```{r base_datos}
BaseSalarios <- read_excel("BaseSalarios.xlsx")
```

Se corrige el formato de algunas columnas.

```{r formato_columnas}
BaseSalarios$Fec.Nac <- as.Date(BaseSalarios$Fec.Nac)

BaseSalarios <- BaseSalarios %>%
  rename(Cuotas = Coutas)
```

Ahora se procede con los ejercicios.

## Parte I

### 1)

Agregamos la categoría de nivel, en esta, se pondrá un $1$ si la observación tiene menos de $150$ cuotas y $2$ si se tienen más o igual cantidad de cuotas, pues no se especifica qué hacer con las personas que tienen exactamente las $150$ cuotas.

```{r categoria_nivel}
BaseSalarios <- BaseSalarios %>% 
  mutate(Nivel = ifelse(Cuotas < 150, 1, 2))
```

### 2)

Generamos una tabla resumen con los requisitos solicitados.

```{r tabla_res}
(resumen <- BaseSalarios %>% 
  group_by(Nivel) %>% 
  summarise(prom_sal = mean(U.Salario, na.rm = TRUE),
            prom_sex = mean(Sexo, na.rm = TRUE),
            var_sal = var(U.Salario, na.rm = TRUE),
            var_sex = var(Sexo, na.rm = TRUE),
            cant_sal = length(U.Salario),
            cant_sex = length(Sexo),
            max_sal = max(U.Salario, na.rm = TRUE),
            max_sex = max(Sexo, na.rm = TRUE),
            min_sal = min(U.Salario, na.rm = TRUE),
            min_sex = min(Sexo, na.rm = TRUE)))
```

### 3)

El diagrama de caja, o diagrama de cajas y bigotes, es un gráfico que muestra la distribución de los datos con $5$ puntos principales, el máximo, el mínimo y los $3$ cuartiles de los datos, es decir, muestra los $4$ cuartiles de la muestra de datos y sus extremos. Junto a toda esa información, se logra observar una medida de tendencia central (mediana), medidas de dispersión (el rango y el rango intercuartílico) y la simetría o asimetría de una función, pues los datos pueden estar concentrados en alguno de los extremos de la distribución, en el centro o en un punto medio de estos (Flores, J., & Flores, R. 2018).

### 4)



### 5)

### 6)

## Parte II

### 1)

### 2)

### 3)

## Parte III

### 1)

El Criterio de Información de Akaike (AIC) es una herramienta objetiva que cuantifica la idoneidad de un modelo específico en comparación con un conjunto limitado de modelos. Ofrece un método sencillo y objetivo para seleccionar el modelo más apropiado para describir los datos observados ().

Por lo tanto, el Criterio de Información de Akaike es una medida utilizada para comparar y seleccionar modelos estadísticos, especialmente en contextos donde se emplea la máxima verosimilitud. El AIC se basa en la idea de evaluar tanto la calidad del ajuste del modelo como su complejidad, y su fórmula está dada por:

AIC = $2k - 2ln(\hat{L})$,

donde $k$ es el número de parámetros libres del modelo y $\hat{L}$ es la función de máxima verosimilitud.

Este método nos da una aproximación de la distancia entre el modelo y el verdadero proceso que genera los datos observados, el cual es desconocido y a veces hasta difícil de definir. Dado que la estimación está basada en los datos observados, esta distancia es siempre relativa y depende del conjunto de datos que se utilizó. Por lo tanto, un valor de AIC no tiene un significado por sí mismo, sino que es interpretable al compararse con otros valores de AIC utilizando los mismos datos observados ().

En este sentido, el término $2k$ penaliza la complejidad del modelo, previniendo que este sea demasiado complejo, lo cual podría llevar a un sobreajuste, mientras que el término $-2ln(\hat{L})$ representa el ajuste del modelo a los datos. Un valor más bajo indicaría un mejor ajuste.

Por lo tanto, el AIC equilibra el ajuste del modelo con su simplicidad, penalizando la adición de parámetros que no mejoran significativamente el ajuste del modelo. De esta manera, cuando se comparan dos o más modelos, el modelo preferido es el que tiene el AIC más bajo, ya que significa que el modelo logra un buen equilibrio entre simplicidad y ajuste a los datos.

### 2)

```{r 3.2}
comparacion.univariate <- model_select(BaseSalarios$Cuotas, 
                                       models = c("exp", "gamma", "lnorm", 
                                                  "weibull", "lgamma", "unif"), 
                                       criterion = "aic",
                                       na.rm = TRUE)
comparacion.univariate
```

### 3)

```{r 3.3}
comparacion.rrisk <- fit.cont(BaseSalarios$Cuotas)
```

### 4)

Como se puede observar en el dataframe del punto anterior, bajo el criterio del AIC, la distribución Weibull es la que más se aproxima a la variable Cuotas, el cual es el mismo resultado que en el punto 2 de esta parte. Además, los parámetros de dicha distribución obtenidos en los puntos 2 y 3 son prácticamente los mismos, por lo que se decide seleccionar la distribución Weibull como la más idónea para los datos de la variable Cuotas.

### 5)

Con la distribución seleccionada, se procede a construir un intervalo de confianza para la media y la desviación estándar de la variable Cuotas.

```{r 3.5}
ic.media <- bootstrapml(comparacion.univariate, map = mean)
ic.desv.est <- bootstrapml(comparacion.univariate, map = sd)

ic.media
ic.desv.est
```

## Parte IV

### 1)

El propósito de la función kde() es poder realizar una estimación de densidad de núcleo (kernel density estimation) en uno o varios puntos. Es importante que no se asume una forma específica de la distribución para estimar la densidad de probabilidad de un conjunto de datos observados. Es decir, es una técnica no paramétrica para poder suavizar los datos utilizando un kernel. Es compatible con diferentes tipos de kernel. 

A continuación un ejemplo con la fila 'Cuotas': 

```{r 4.1}
cuotas.kde <- kde(x = BaseSalarios$Cuotas)

plot(cuotas.kde)
```

### 2)

La función boot.ci() se utiliza con el propósito de calcular intervalos de confianza para estimaciones obtenidas a través de un proceso de bootstrap. Bootstrap es un método que permite estimar la distribución de un estadístico mediante muestras repetidas con reemplazo de los datos originales. Además, proporciona diferentes tipos de intervalos de confianza. Esta función toma como entrada un objeto de la clase boot, generado a partir de la función boot(), que contiene los resultados del procedimiento bootstrap.

### 3)

```{r 4.2}
media.boot <- function(data, indices){
  
  muestra.boot <- data[indices]
  
  return(mean(muestra.boot))
}

resultados.boot <- boot(data = BaseSalarios$Cuotas, 
                        statistic = media.boot, 
                        R = 1000)

plot(resultados.boot)
```

## Referencias

[El Criterio de Información de Akaike en la Obtención de Modelos Estadísticos de Rendimiento](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=&cad=rja&uact=8&ved=2ahUKEwjjiNTx37KIAxXoRjABHe6zJjYQFnoECBUQAQ&url=https%3A%2F%2Fwww.researchgate.net%2Fprofile%2FTomas-Pena%2Fpublication%2F236279245_El_criterio_de_informacion_de_Akaike_en_la_obtencion_de_modelos_estadisticos_de_Rendimiento%2Flinks%2F58904fa3aca272bc14be3600%2FEl-criterio-de-informacion-de-Akaike-en-la-obtencion-de-modelos-estadisticos-de-Rendimiento.pdf&usg=AOvVaw251RhnkX_-d-T-YnQMd_sa&opi=89978449)

[La Enseñanza del Diagrama de Caja y Bigotes para Mejorar su Interpretación](https://revistas.utm.edu.ec/index.php/Basedelaciencia/article/download/1107/1102)

Flores, J., & Flores, R. (2018). La enseñanza del diagrama de caja y bigotes para mejorar su interpretación. Revista Bases de la Ciencia. e-ISSN 2588-0764, 3(1), 69-75.